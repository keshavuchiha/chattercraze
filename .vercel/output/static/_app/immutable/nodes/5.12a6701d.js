import{e as he}from"../chunks/index.93323930.js";import{s as ge,e as re,y as Z,p as E,r as be}from"../chunks/scheduler.b9ed97e5.js";import{S as ve,i as ke,g as v,s as P,m as C,r as ie,h as k,j,f,c as V,n as J,u as ce,k as _,a as g,D as h,v as ue,o as R,d as T,t as N,b as me,w as fe,e as B,p as de,E as ye,y as z}from"../chunks/index.90fc35b1.js";import{A as we,h as ee,u as je}from"../chunks/AboutCommunity.0b9ede6d.js";import{g as _e,a as pe,e as te,u as $e,o as Se}from"../chunks/spread.c6c0f159.js";import{I as se,d as Ie,r as Oe}from"../chunks/relativeTime.a2fa3610.js";import{i as le}from"../chunks/navigation.f999d11e.js";import{P as Te}from"../chunks/Post.ffa1c614.js";const Ee=async({params:n,parent:e,fetch:t})=>{const{description:l,created_at:o,count:a,image_url:u}=await e();let s=!1,r=null,i=null;{let p=await t("/society/posts",{method:"POST",headers:{"Content-Type":"application/json","x-auth-token":localStorage.getItem("x-auth-token")||""},body:JSON.stringify({name:n.name})});if(console.log(p.status),p.ok&&(r=p.json()),p=await t("/society/user",{method:"POST",body:JSON.stringify({name:n.name})}),console.log(p.status),p.ok){const y=await p.json();s=y.joined,s&&(i=y.role)}else throw he(p.status,p.statusText)}return{name:n.name,joined:s,posts_promise:r,description:l,created_at:o,count:a,image_url:u,role:i}},Fe=Object.freeze(Object.defineProperty({__proto__:null,load:Ee},Symbol.toStringTag,{value:"Module"}));function oe(n,e,t){const l=n.slice();return l[7]=e[t],l}function De(n){let e,t="Join",l,o;return{c(){e=v("button"),e.textContent=t,this.h()},l(a){e=k(a,"BUTTON",{class:!0,"data-svelte-h":!0}),ye(e)!=="svelte-9lwx90"&&(e.textContent=t),this.h()},h(){_(e,"class","bg-emerald-600 w-28 text-white px-8 py-0.5 rounded-3xl hover:bg-emerald-500")},m(a,u){g(a,e,u),l||(o=z(e,"click",n[5]),l=!0)},p:E,d(a){a&&f(e),l=!1,o()}}}function Pe(n){let e,t,l,o;return{c(){e=v("button"),t=C(n[1]),this.h()},l(a){e=k(a,"BUTTON",{class:!0});var u=j(e);t=J(u,n[1]),u.forEach(f),this.h()},h(){_(e,"class","px-8 border-2 w-28 rounded-3xl text-emerald-600 py-0.5 hover:text-red-500")},m(a,u){g(a,e,u),h(e,t),l||(o=[z(e,"click",n[2]),z(e,"mouseenter",n[3]),z(e,"mouseleave",n[4])],l=!0)},p(a,u){u&2&&R(t,a[1])},d(a){a&&f(e),l=!1,be(o)}}}function ae(n){let e,t,l,o={ctx:n,current:null,token:null,hasCatch:!0,pending:Je,then:Ce,catch:Ve,value:6,error:10,blocks:[,,,]};return ee(t=n[0].posts_promise,o),{c(){e=B(),o.block.c()},l(a){e=B(),o.block.l(a)},m(a,u){g(a,e,u),o.block.m(a,o.anchor=u),o.mount=()=>e.parentNode,o.anchor=e,l=!0},p(a,u){n=a,o.ctx=n,u&1&&t!==(t=n[0].posts_promise)&&ee(t,o)||je(o,n,u)},i(a){l||(T(o.block),l=!0)},o(a){for(let u=0;u<3;u+=1){const s=o.blocks[u];N(s)}l=!1},d(a){a&&f(e),o.block.d(a),o.token=null,o=null}}}function Ve(n){let e;return{c(){e=C("error loading posts")},l(t){e=J(t,"error loading posts")},m(t,l){g(t,e,l)},p:E,i:E,o:E,d(t){t&&f(e)}}}function Ce(n){let e,t=[],l=new Map,o,a=te(n[6]);const u=s=>s[7].title;for(let s=0;s<a.length;s+=1){let r=oe(n,a,s),i=u(r);l.set(i,t[s]=ne(i,r))}return{c(){e=v("div");for(let s=0;s<t.length;s+=1)t[s].c();this.h()},l(s){e=k(s,"DIV",{class:!0});var r=j(e);for(let i=0;i<t.length;i+=1)t[i].l(r);r.forEach(f),this.h()},h(){_(e,"class","space-y-3 mx-4")},m(s,r){g(s,e,r);for(let i=0;i<t.length;i+=1)t[i]&&t[i].m(e,null);o=!0},p(s,r){r&1&&(a=te(s[6]),de(),t=$e(t,r,u,1,s,a,l,e,Se,ne,null,oe),me())},i(s){if(!o){for(let r=0;r<a.length;r+=1)T(t[r]);o=!0}},o(s){for(let r=0;r<t.length;r+=1)N(t[r]);o=!1},d(s){s&&f(e);for(let r=0;r<t.length;r+=1)t[r].d()}}}function ne(n,e){let t,l,o;const a=[e[7]];let u={};for(let s=0;s<a.length;s+=1)u=re(u,a[s]);return l=new Te({props:u}),{key:n,first:null,c(){t=B(),ie(l.$$.fragment),this.h()},l(s){t=B(),ce(l.$$.fragment,s),this.h()},h(){this.first=t},m(s,r){g(s,t,r),ue(l,s,r),o=!0},p(s,r){e=s;const i=r&1?_e(a,[pe(e[7])]):{};l.$set(i)},i(s){o||(T(l.$$.fragment,s),o=!0)},o(s){N(l.$$.fragment,s),o=!1},d(s){s&&f(t),fe(l,s)}}}function Je(n){let e;return{c(){e=C("Loading")},l(t){e=J(t,"Loading")},m(t,l){g(t,e,l)},p:E,i:E,o:E,d(t){t&&f(e)}}}function Ne(n){let e,t,l,o,a,u,s,r=n[0].name+"",i,p,y,U,x=n[0].name+"",A,G,S,L,w,I,F,$,O;function W(c,m){return c[0].joined?Pe:De}let M=W(n),b=M(n),d=n[0].posts_promise&&ae(n);const H=[n[0]];let K={};for(let c=0;c<H.length;c+=1)K=re(K,H[c]);return $=new we({props:K}),{c(){e=v("div"),t=P(),l=v("div"),o=v("img"),u=P(),s=v("div"),i=C(r),p=P(),y=v("div"),U=C("society/"),A=C(x),G=P(),S=v("div"),b.c(),L=P(),w=v("div"),I=v("div"),d&&d.c(),F=P(),ie($.$$.fragment),this.h()},l(c){e=k(c,"DIV",{class:!0}),j(e).forEach(f),t=V(c),l=k(c,"DIV",{class:!0});var m=j(l);o=k(m,"IMG",{src:!0,alt:!0,class:!0}),u=V(m),s=k(m,"DIV",{class:!0});var D=j(s);i=J(D,r),p=V(D),y=k(D,"DIV",{class:!0});var Q=j(y);U=J(Q,"society/"),A=J(Q,x),Q.forEach(f),D.forEach(f),G=V(m),S=k(m,"DIV",{class:!0});var X=j(S);b.l(X),X.forEach(f),m.forEach(f),L=V(c),w=k(c,"DIV",{class:!0});var q=j(w);I=k(q,"DIV",{class:!0});var Y=j(I);d&&d.l(Y),Y.forEach(f),F=V(q),ce($.$$.fragment,q),q.forEach(f),this.h()},h(){_(e,"class","h-20 bg-emerald-400"),Z(o.src,a=n[0].image_url||se)||_(o,"src",a),_(o,"alt","icon"),_(o,"class","relative rounded-[50%] bg-emerald-700 border-4 border-white -mt-5 ml-6 mr-4 h-14 w-14"),_(y,"class","text-sm text-zinc-400 font-normal"),_(s,"class","font-semibold text-2xl"),_(S,"class","space-x-2 my-1 mx-6"),_(l,"class","h-30 flex flex-row"),_(I,"class","col-span-9"),_(w,"class","grid grid-cols-12 mx-4")},m(c,m){g(c,e,m),g(c,t,m),g(c,l,m),h(l,o),h(l,u),h(l,s),h(s,i),h(s,p),h(s,y),h(y,U),h(y,A),h(l,G),h(l,S),b.m(S,null),g(c,L,m),g(c,w,m),h(w,I),d&&d.m(I,null),h(w,F),ue($,w,null),O=!0},p(c,[m]){(!O||m&1&&!Z(o.src,a=c[0].image_url||se))&&_(o,"src",a),(!O||m&1)&&r!==(r=c[0].name+"")&&R(i,r),(!O||m&1)&&x!==(x=c[0].name+"")&&R(A,x),M===(M=W(c))&&b?b.p(c,m):(b.d(1),b=M(c),b&&(b.c(),b.m(S,null))),c[0].posts_promise?d?(d.p(c,m),m&1&&T(d,1)):(d=ae(c),d.c(),T(d,1),d.m(I,null)):d&&(de(),N(d,1,1,()=>{d=null}),me());const D=m&1?_e(H,[pe(c[0])]):{};$.$set(D)},i(c){O||(T(d),T($.$$.fragment,c),O=!0)},o(c){N(d),N($.$$.fragment,c),O=!1},d(c){c&&(f(e),f(t),f(l),f(L),f(w)),b.d(),d&&d.d(),fe($)}}}function xe(n,e,t){let{data:l}=e,o="Joined";Ie.extend(Oe);const a=async()=>{const i=await fetch("/society/leave",{method:"POST",body:JSON.stringify({name:l.name})});if(i.status>=400&&i.status<=600){alert((await i.json()).message);return}i.ok&&le()},u=()=>t(1,o="Leave"),s=()=>t(1,o="Joined"),r=async()=>{const i=await fetch("/society/join",{method:"POST",body:JSON.stringify({name:l.name})});if(i.status>=400&&i.status<=600){alert((await i.json()).message);return}i.ok&&le()};return n.$$set=i=>{"data"in i&&t(0,l=i.data)},[l,o,a,u,s,r]}class He extends ve{constructor(e){super(),ke(this,e,xe,Ne,ge,{data:0})}}export{He as component,Fe as universal};
